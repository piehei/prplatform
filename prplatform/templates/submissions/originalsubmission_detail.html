
{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load django_bootstrap_breadcrumbs %}

{% block breadcrumbs %}
    {{ block.super }}
    {% breadcrumb object.course.code object.course.get_absolute_url %}
    {% breadcrumb "Exercise" ""%}
    {% breadcrumb object.exercise.name object.exercise.get_absolute_url %}
    {% breadcrumb "List" "courses:submissions:original-list" object.course.base_course.url_slug object.course.url_slug object.exercise.pk %}
    {% breadcrumb "Submission" "" %}
{% endblock %}

{% block content %}

  {% include "../tabs.html" with tab="submissions" type="original" object=object.exercise %}

  <div class="row">
    <div class="col-sm-12">
      <h4>Original submission to exercise: <a href="{{ object.exercise.get_absolute_url }}">{{ object.exercise.name }}</a></h4>
      <p>
        <b>Submitter</b>: {{ object.submitter_user }}<br>
        {% if object.submitter_group %}<b>Group</b>: {{ object.submitter_group }}<br>{% endif %}
        <b>Submission time</b>: {{ object.created }}<br>
      </p>

      {% if object.text %}

        <p><b>Submission text:</b></p>
        <div class="col-sm-6 ml-4 mb-4">
          {{ object.text | linebreaks }}
        </div>

      {% endif %}

      {% if object.file %}

      <p><b>Submitted file: (<a href="{{ object.get_file_download_url }}">download</a>)</b></p>
        <div class="card card-body"
             style="background:#FFE;">
        <br>
        {% load pygmentify %}
        {% pygment %}
          <!-- TODO: general implementation for any contents -->
          <pre lang="python">{{ filecontents }}</pre>
        {% endpygment %}

        </div>
      {% endif %}

      {% if teacher %}
      <hr></hr>
      <h2>Teacher feedback to student:</h2>
      <small>If you've enabled the "use states" option in the exercise configuration, you
             can change the state of the submission here. You can either give the student
             a boomerang or OK the submission and turn it ready for peer-review.</small>
        <form class="form-horizontal" method="post"
                                      action="{{ object.get_update_state_url }}">
          {% csrf_token %}

          {{ state_form|crispy }}

          <button type="submit" class="btn btn-primary btn-sm">Save</button>
        </form>
      {% endif %}

    </div>
  </div>
{% endblock content %}

