
{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}
{% load django_bootstrap_breadcrumbs %}

{% block breadcrumbs %}
    {{ block.super }}
    {% breadcrumb object.course.code object.course.get_absolute_url %}
    {% breadcrumb "Exercise" ""%}
    {% breadcrumb object.name "" %}
{% endblock %}

{% block content %}

  {% include "../tabs.html" with tab="exercise" type="original" %}

  <div class="row">
    <div class="col-md-12">
      <h2>{{ object.name }}</h2>

      {% if not object.is_open %}
        <div class="alert alert-danger d-md-inline-block">
          {% if object.opens_in_future %}
          This exercise will open on {{ object.opening_time }}
          {% else %}
          This exercise was closed on {{ object.closing_time }}
          {% endif %}
        </div>
        <br>
      {% endif %}

      <div class="col-md-12">
        {{ object.description | linebreaks }}
      </div>


      {% if my_submissions and disable_form %}

        <div class="alert alert-danger font-italic d-md-inline-block">
          <b>You have reached the maximum number of submissions</b>
        </div>
        <br>

      {% endif %}

      {% if object.type == 'APLUS' %}

        This exercise retrieves your submission in Plus. You're supposed to make your submission over there.

      {% else %}

        <form enctype="multipart/form-data"
              action="{{ object.get_absolute_url }}"
              method="post">
              {% csrf_token %}
              {{ form | crispy }}

              {% if object.use_groups and enrolled %}
              <div class="alert alert-{% if my_group %}secondary{% else %}danger{% endif %} d-md-inline-block">
                  In this exercise you're submitting as a group.
                  <br>
                  {% if my_group %}
                    Members in your group: {{ my_group.student_usernames }}
                  {% elif teacher %} <!-- TODO: how can the teacher override this and submit as a group???? -->
                    You're a teacher. You don't belong to any group and cannot submit.
                  {% else %}
                    You have not been assigned to any group! Contact course personnel to make a submission.
                  {% endif %}
              </div>
              <br>
              {% endif %}

              {% if not enrolled %}
              <div class="alert alert-warning d-md-inline-block">
                You have to enroll to the course in order to submit.<br>
                You can enroll from the <a href="{{ course.get_absolute_url }}">course page</a>.
              </div>
              <br>
              {% endif %}
              <input type="submit" class="btn btn-primary" value="Submit"
                     {% if disable_form %}disabled{% endif %}>
          </form>

      {% endif %}

    </div>
  </div>
{% endblock content %}

